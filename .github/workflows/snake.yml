name: Snake

on:
  schedule:
    - cron: "0 */12 * * *" # Runs every 12 hours
  workflow_dispatch: # Allows manual trigger

jobs:
  generate-snake:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout repository
      uses: actions/checkout@v2

    - name: Generate snake SVG
      uses: platane/snk@v3
      with:
        github_user_name: 'pree-tisingh'  # Your GitHub username
        github_token: ${{ secrets.GITHUB_TOKEN }}  # Use GitHub's built-in token for authentication
        outputs: |
          svg=github-contribution-grid-snake.svg
          png=github-contribution-grid-snake.png

    - name: Check if SVG file exists
      run: |
        if [ -f github-contribution-grid-snake.svg ]; then
          echo "SVG file exists."
        else
          echo "SVG file does not exist."
          exit 1
        fi

    - name: Commit and push if there are changes
      run: |
        git config --local user.name "GitHub Action"
        git config --local user.email "action@github.com"
        git add github-contribution-grid-snake.svg
        git commit -m "Update contribution snake" || echo "No changes to commit"
        git push
